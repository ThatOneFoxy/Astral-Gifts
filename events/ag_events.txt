namespace = ag_events

country_event = {
    id = ag_events.100
    hide_window = yes
    is_triggered_only = yes

    immediate = {
     add_modifier = { modifier = ag_midgame_astral_storage }
        set_country_flag = midgamepassedag
    }
}

country_event = {
    id = ag_events.101
    hide_window = yes
    is_triggered_only = yes

    trigger = {
        NOT = {
            has_country_flag = riftworldoriginag
        }
        owner = {
            has_origin = origin_riftworld
        }
    }
    immediate = {
        set_country_flag = riftworldoriginag
    }
}

country_event = {
    id = ag_events.2000
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        inverted_switch = {
            trigger = has_technology
            tech_genome_mapping = {
                add_tech_progress = {
                    tech = tech_genome_mapping
                    progress = @agenda_award_tech_progress
                }
            }
            tech_gene_tailoring = {
                add_tech_progress = {
                    tech = tech_gene_tailoring
                    progress = @agenda_award_tech_progress
                }
            }
            tech_glandular_acclimation = {
                add_tech_progress = {
                    tech = tech_glandular_acclimation
                    progress = @agenda_award_tech_progress
                }
            }
            tech_gene_expressions = {
                add_tech_progress = {
                    tech = tech_gene_expressions
                    progress = @agenda_award_tech_progress
                }
            }
            tech_gene_seed_purification = {
                add_tech_progress = {
                    tech = tech_gene_seed_purification
                    progress = @agenda_award_tech_progress
                }
            }
            default = {
                add_monthly_resource_mult = {
                    resource = society_research
                    value = @tier3researchreward
                    min = @tier3researchmin
                    max = @tier3researchmax
                }
            }
        }
    }
}

country_event = {
    id = ag_events.2001
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        inverted_switch = {
            trigger = has_technology
            tech_powered_exoskeletons = {
                add_tech_progress = {
                    tech = tech_powered_exoskeletons
                    progress = @agenda_award_tech_progress
                }
            }
            tech_robotic_workers = {
                add_tech_progress = {
                    tech = tech_robotic_workers
                    progress = @agenda_award_tech_progress
                }
            }
            tech_droid_workers = {
                add_tech_progress = {
                    tech = tech_droid_workers
                    progress = @agenda_award_tech_progress
                }
            }
            tech_administrative_ai = {
                add_tech_progress = {
                    tech = tech_administrative_ai
                    progress = @agenda_award_tech_progress
                }
            }
            tech_self_aware_logic = {
                add_tech_progress = {
                    tech = tech_self_aware_logic
                    progress = @agenda_award_tech_progress
                }
            }
            tech_sapient_ai = {
                add_tech_progress = {
                    tech = tech_sapient_ai
                    progress = @agenda_award_tech_progress
                }
            }
            tech_synthetic_workers = {
                add_tech_progress = {
                    tech = tech_synthetic_workers
                    progress = @agenda_award_tech_progress
                }
            }
            tech_synthetic_leaders = {
                add_tech_progress = {
                    tech = tech_synthetic_leaders
                    progress = @agenda_award_tech_progress
                }
            }
            default = {
                add_monthly_resource_mult = {
                    resource = engineering_research
                    value = @tier3researchreward
                    min = @tier3researchmin
                    max = @tier3researchmax
                }
            }
        }
    }
}

country_event = {
    id = ag_events.3000
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        random = {
            chance = 10
            if = {
                limit = {
                    NOT = {
                        has_country_flag = techharvestingunlocked
                    }
                }
                add_tech_progress = {
                    tech = tech_astral_harvesting
                    progress = 0.25
                }
                set_country_flag = techharvestingunlocked
            }
            else = {
                add_resource = { astral_threads = 150 }
            }
        }
        random = {
            chance = 15
            add_resource = { astral_threads = 100 }
        }
        random = {
            chance = 20
            add_resource = { astral_threads = 50 }
        }
        random = {
            chance = 55
            random_owned_leader = {
                if = {
                    limit = {
                        owner = {
                            has_country_flag = lastpositivetrait
                        }
                    }
                    random = {
                        chance = 50
                        add_trait = "random_negative"
                        owner = {
                            remove_country_flag = lastpositivetrait
                            set_country_flag = lastnegativetrait
                        }
                    }
                }
                else_if = {
                    limit = {
                        owner = {
                            has_country_flag = lastnegativetrait
                        }
                    }
                    random = {
                        chance = 50
                        add_trait = "random_common"
                        owner = {
                            remove_country_flag = lastnegativetrait
                            set_country_flag = lastpositivetraittrait
                        }
                    }
                }
            }
        }
    }
}

event = {
    id = ag_events.3001
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_country = {
            set_country_flag = lastpositivetrait
        }
    }
}

astral_rift_event = {
    id = ag_events.1
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        solar_system = {
            system_event = {
                id = ag_astralplanes.2
                days = 2	# Trigger the event once the science ship has returned from exploration (MIA)
                scopes = { from = root fromfrom = root.fleet }
            }
        }
    }
}

astral_rift_event = {
    id = ag_events.2
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        solar_system = {
            system_event = {
                id = ag_astralplanes.2
                days = 2	# Trigger the event once the science ship has returned from exploration (MIA)
                scopes = { from = root fromfrom = root.fleet }
            }
        }
        finish_astral_rift = yes
    }
}



